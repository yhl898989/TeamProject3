<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.dw.item">
  
  
  <delete id="deleteitemimgfile">
  
  DELETE FROM itemfileupload WHERE iId = #{iId}
  
  </delete>
  
  <delete id="deleteitem">
  
  DELETE FROM tbl_item WHERE iId = #{iId}
 
  </delete>
  
  <update id="updateitem">
  
  UPDATE tbl_item SET iName = #{iName}, iPrice = #{iPrice} ,iDc = #{iDc}, iCount = #{iCount}, i_CATEGORY = #{i_CATEGORY} WHERE iId = #{iId}
  
  </update>
  
  
  <select id="search" resultType="iTemDTO">
  <if test ="criteria == 'iName'">
  SELECT * FROM tbl_item WHERE iName like '%'||#{keyword}||'%'
  </if>
  </select>
  
  
  <select id="getitemfilelist" resultType="string">
  
  SELECT ifilename FROM itemfileupload WHERE iId = #{iId}
  </select>
  
  <select id="categoryListiPriceasc" resultType="iTemDTO">
  
  SELECT * FROM tbl_item WHERE i_CATEGORY = #{category} ORDER BY iPrice ASC
  
  </select>
  
  <select id="categoryListiPricedesc" resultType="iTemDTO">
  
  SELECT * FROM tbl_item WHERE i_CATEGORY = #{category} ORDER BY iPrice DESC
  
  </select>
  
  <select id="categoryListitemsequence" resultType="iTemDTO">
  
  SELECT * FROM tbl_item WHERE i_CATEGORY = #{category} ORDER BY iId DESC
  
  </select>
  
  <select id="categoryList" resultType="itemDTO">
  
  SELECT * FROM tbl_item WHERE i_CATEGORY = #{category}
  
  
  </select>
  
  
  <select id="adminlist" resultType="itemDTO">
  
  SELECT * FROM tbl_item order by iId desc
  
  </select>
  
  <select id="read" resultType="itemDTO">
  
  SELECT * FROM tbl_item WHERE iId = #{iId}
  
  </select>
  
  
  <insert id="insert">
  
  INSERT INTO tbl_item (iId, iName, iPrice, iDc, iCount, ifilename, i_CATEGORY) 
  VALUES (seq_item_iId.NEXTVAL, #{iName}, #{iPrice}, #{iDc}, #{iCount}, #{ifilename}, #{i_CATEGORY})
  <selectKey resultType="int" keyProperty="iId" order="AFTER">
  	select seq_item_iId.CURRVAL from DUAL
  </selectKey>
  </insert>
  
  <insert id="upload">
  INSERT INTO itemfileupload (iId, ifilename) VALUES (#{iId},#{ifilename})
  </insert>
  
  <select id="list" resultType="ItemDTO">
  
  SELECT * FROM tbl_item
  
  </select>

</mapper>